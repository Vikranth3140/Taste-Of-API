<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taste Of API - Cuisines</title>
    <link rel="stylesheet" type="text/css" href="food.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: rgb(255, 249, 196);
        }
        h1 {
            padding-top: 10px;
            text-align: center;
            color: #864747;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #logo {
            width: 100px;
            height: 100px;
            margin: 10px;
        }
        #chatbot {
            width: 50px;
            height: 50px;
        }
        nav {
            background-color: teal;
            display: flex;
            justify-content: center;
            height: 20px;
        }
        nav ul {
            list-style-type: none;
            display: flex;
        }
        nav ul a {
            display: flex;
            align-items: center;
            padding: 20px;
            text-decoration: none;
            color: #000;
            transition: 0.5s ease-in;
            font-size: 18px;
        }

        #apiForm {
            text-align: center;
            margin-top: 20px;
        }

        #chatInput {
            width: 60%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 16px;
        }

        #submitBtn {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        #submitBtn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Taste Of API<img src="resources\TasteOfAPI.png" id="logo" alt="Taste Of API"></h1>
    <nav>
        <ul>
            <a href="index.html"><li><img src="resources\chatbot.png" id="chatbot"></li></a>
        </ul>
    </nav>

    <div>
        <form id="apiForm" onsubmit="getAPIResponse(event)">
            <label for="chatInput">Enter your favourite dish</label>
            <br>
            <input type="text" id="chatInput" name="prompt">
            <br>
            <input type="submit" id="submitBtn" value="Submit">
        </form>
    </div>

    <script>
        const clientId = "app-ims";
        const grantType = "password";
        const username = "forkit-hackathon";
        const password = "forkitiiitdelhi";
        const scope = "openid";

        const baseUrl = "https://cosylab.iiitd.edu.in/api/recipeDB/search_subregion/";
        const bearerToken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI1N1R4M2FWRzR0N0Q5YW00TDlod1VHR2tPVVlvOUpwVFd1VTNmTWxrY1lBIn0.eyJleHAiOjE3MDAyNzI3MDgsImlhdCI6MTcwMDI3MjQwOCwianRpIjoiY2JkMjJkZDMtZjcyMi00MGRjLWFiZGItYzRkYmRjZDdhOWNjIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvcmVhbG1zL2Jvb3RhZG1pbiIsImF1ZCI6WyJhcHAtYWRtaW4iLCJhcHAtdG9kbyIsImFjY291bnQiXSwic3ViIjoiMmEzNzU0NzAtMjU4Ni00MDM4LWEzODUtMTY1OGMxOGVjMTJhIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYXBwLWltcyIsInNlc3Npb25fc3RhdGUiOiI0MzA4NDczOS1lODVhLTQyYzMtYjM1Ny1jYTJiOTQzZGE0MmQiLCJhY3IiOiIxIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhcHAtYWRtaW4iOnsicm9sZXMiOlsiYWRtaW4iXX0sImFwcC10b2RvIjp7InJvbGVzIjpbImFkbWluIiwidXNlciJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgZW1haWwgcHJvZmlsZSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoiZm9ya2l0LWhhY2thdGhvbiJ9.A5QI4vwjJ32oeaDfvqCSFJIHZiojb61wCL1STFhxPg5WXYDITmeYrhHuroqfMnAK-1A3KCUt7B1NTQZTrH-xKtRU_Yj35h5YwkPwjbSho4U_5Ka0k9Zl_Z2P_Whhg9uGMRHrG8iaY3FSTXPXv1Ba4y0gT95JWdzRvNh59aReF7_6E9qEGNIgAko6Qgif2c7Zh1N5PyCo4QD-spqCqya5zx7o9lKravIHFKhmovJcudYIMSdkP-pl6kgq63G_Twq7NaaUpe5ASPuSBzul-AoUWUmctvqTDBKd2FKryBISoDI7zVZBJHXOsB9cluCXVuSPQRsGJVle_zcLGjv86h4xvw";

        const params = {
        client_id: clientId,
        grant_type: grantType,
        username: username,
        password: password,
        scope: scope
        };

        function makeApiRequest(prompt) {
        const completeUrl = baseUrl + prompt;

        const headers = {
            "Authorization": `Bearer ${bearerToken}`,
            "Content-Type": "application/json"
        };

        console.log("Making API request to:", completeUrl);

        fetch(completeUrl, { headers })
            .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
            })
            .then(data => {
            console.log("API response:", data);
            displayResults(data);
            })
            .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
            });
        }

        function displayResults(data) {
        console.log("Displaying results:", data);
        
        const resultsContainer = document.getElementById('results');
        resultsContainer.innerHTML = '';

        data.forEach(element => {
            const recipe = document.createElement('div');
            recipe.innerHTML = `
            <p>${element.recipe_title}</p>
            <p>Calories: ${element.calories}</p>
            <p>Protein: ${element.protein}</p>
            `;
            resultsContainer.appendChild(recipe);
        });
        }

        function getAPIResponse(event) {
        event.preventDefault();
        const promptInput = document.getElementById('chatInput');
        const promptValue = promptInput.value.trim();

        if (promptValue) {
            console.log("Submitting API request with prompt:", promptValue);
            makeApiRequest(promptValue);
        } else {
            alert('Please enter a prompt.');
        }
    }
    </script>
</body>
</html>